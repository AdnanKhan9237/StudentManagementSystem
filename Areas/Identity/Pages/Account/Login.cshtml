@page
@model StudentManagementSystem.Areas.Identity.Pages.Account.LoginModel
@{
    ViewData["Title"] = "Log in";
    Layout = "~/Views/Shared/_LoginLayout.cshtml";
}

@if (TempData["ErrorMessage"] != null)
{
    <div class="alert alert-danger" role="alert">
        @TempData["ErrorMessage"]
    </div>
}

<div class="login-header">
    <div class="logo">
        <i class="fas fa-graduation-cap"></i>
    </div>
    <h1>Welcome Back</h1>
    <p>Sign in to your account to continue</p>
</div>

<form id="account" method="post">
    @Html.AntiForgeryToken()
    <input type="hidden" asp-for="ReturnUrl" />
    <div asp-validation-summary="ModelOnly" class="validation-summary-errors" role="alert"></div>
    
    <div class="form-floating">
        <input asp-for="Input.Email" class="form-control" autocomplete="username" aria-required="true" />
        <label asp-for="Input.Email"></label>
        <span asp-validation-for="Input.Email" class="text-danger"></span>
    </div>
    
    <div class="form-floating">
        <input asp-for="Input.Password" type="password" class="form-control" autocomplete="current-password" aria-required="true" />
        <label asp-for="Input.Password">Password</label>
        <span asp-validation-for="Input.Password" class="text-danger"></span>
    </div>
    
    <button id="login-submit" type="submit" class="btn btn-login">
        <span class="login-text">Sign In</span>
        <span class="spinner-border spinner-border-sm" role="status" aria-hidden="true" style="display: none;"></span>
    </button>
    
</form>

@section Scripts {
    <partial name="_ValidationScriptsPartial" />
    <script>
        document.getElementById('account').addEventListener('submit', function() {
            const button = document.getElementById('login-submit');
            const loginText = button.querySelector('.login-text');
            const spinner = button.querySelector('.spinner-border');
            
            button.disabled = true;
            loginText.style.display = 'none';
            spinner.style.display = 'inline-block';
        });

        // Show password toggle functionality
        document.addEventListener('DOMContentLoaded', function() {
            // Focus on first input
            const firstInput = document.querySelector('input[asp-for="Input.Email"]');
            if (firstInput) {
                firstInput.focus();
            }

            // Add enter key support
            document.querySelectorAll('.form-control').forEach(function(input) {
                input.addEventListener('keypress', function(e) {
                    if (e.key === 'Enter') {
                        document.getElementById('login-submit').click();
                    }
                });
            });
        });
    </script>
}