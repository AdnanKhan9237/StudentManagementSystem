@model AttendanceIndexViewModel
@{
    ViewData["Title"] = "Attendance Management";
    Layout = "~/Views/Shared/_ModernLayout.cshtml";
}
    Layout = "~/Views/Shared/_Layout.cshtml";
}

<div class="container-fluid">
    <div class="row">
        <div class="col-12">
            <div class="page-header">
                <div class="page-block">
                    <div class="row align-items-center">
                        <div class="col-md-12">
                            <div class="page-header-title">
                                <h5 class="m-b-10">Attendance Management</h5>
                            </div>
                            <ul class="breadcrumb">
                                <li class="breadcrumb-item">
                                    <a asp-action="Index" asp-controller="Home">
                                        <i class="feather icon-home"></i>
                                    </a>
                                </li>
                                <li class="breadcrumb-item">Attendance Management</li>
                            </ul>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Today's Quick Actions -->
    <div class="row mb-4">
        <div class="col-12">
            <div class="card bg-primary text-white">
                <div class="card-body">
                    <div class="row align-items-center">
                        <div class="col-md-8">
                            <h4 class="text-white mb-1">Today: @Model.TodayDate.ToString("dddd, dd MMMM yyyy")</h4>
                            <p class="text-white-50 mb-0">Mark attendance for your assigned batches</p>
                        </div>
                        <div class="col-md-4 text-right">
                            <i class="fas fa-calendar-check" style="font-size: 3rem; opacity: 0.3;"></i>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Batches List -->
    <div class="row">
        <div class="col-12">
            <div class="card">
                <div class="card-header">
                    <h5>Your Assigned Batches</h5>
                    <div class="float-right">
                        <span class="badge badge-info">@Model.Batches.Count Batch(es)</span>
                    </div>
                </div>
                <div class="card-body">
                    @if (Model.Batches.Any())
                    {
                        <div class="row">
                            @foreach (var batch in Model.Batches)
                            {
                                <div class="col-lg-6 col-md-12 mb-4">
                                    <div class="card border-left-primary">
                                        <div class="card-body">
                                            <div class="row align-items-center">
                                                <div class="col-8">
                                                    <h6 class="mb-1">@batch.BatchName</h6>
                                                    <p class="text-muted mb-1">
                                                        <i class="fas fa-code"></i> @batch.BatchCode |
                                                        <i class="fas fa-tools"></i> @batch.TradeName
                                                    </p>
                                                    <p class="text-muted mb-0">
                                                        <i class="fas fa-calendar-alt"></i> @batch.SessionName |
                                                        <i class="fas fa-users"></i> @batch.StudentCount Students
                                                    </p>
                                                    <div class="mt-2">
                                                        <span class="badge badge-@(batch.Status == "Active" ? "success" : "secondary")">
                                                            @batch.Status
                                                        </span>
                                                    </div>
                                                </div>
                                                <div class="col-4 text-right">
                                                    <div class="btn-group-vertical" role="group">
                                                        <a asp-action="TakeAttendance" asp-route-batchId="@batch.BatchId" 
                                                           asp-route-date="@Model.TodayDate.ToString("yyyy-MM-dd")" 
                                                           class="btn btn-success btn-sm mb-1" title="Take Today's Attendance">
                                                            <i class="fas fa-check"></i> Take Attendance
                                                        </a>
                                                        <a asp-action="ViewAttendance" asp-route-batchId="@batch.BatchId" 
                                                           asp-route-date="@Model.TodayDate.ToString("yyyy-MM-dd")" 
                                                           class="btn btn-info btn-sm mb-1" title="View Today's Attendance">
                                                            <i class="fas fa-eye"></i> View Today
                                                        </a>
                                                        <a asp-action="BatchReport" asp-route-batchId="@batch.BatchId" 
                                                           class="btn btn-outline-primary btn-sm" title="View Reports">
                                                            <i class="fas fa-chart-bar"></i> Reports
                                                        </a>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            }
                        </div>
                    }
                    else
                    {
                        <div class="alert alert-info text-center">
                            <div class="mb-3">
                                <i class="fas fa-info-circle fa-3x text-muted"></i>
                            </div>
                            <h5>No Batches Assigned</h5>
                            <p class="mb-0">You don't have any batches assigned to you yet. Please contact the administrator to get batch assignments.</p>
                        </div>
                    }
                </div>
            </div>
        </div>
    </div>

    <!-- Quick Actions Card -->
    @if (Model.Batches.Any())
    {
        <div class="row">
            <div class="col-12">
                <div class="card">
                    <div class="card-header">
                        <h5>Quick Actions</h5>
                    </div>
                    <div class="card-body">
                        <div class="row text-center">
                            <div class="col-md-3">
                                <div class="mb-3">
                                    <i class="fas fa-calendar-check fa-2x text-success mb-2"></i>
                                    <h6>Take Attendance</h6>
                                    <p class="text-muted small">Mark today's attendance for any of your batches</p>
                                </div>
                            </div>
                            <div class="col-md-3">
                                <div class="mb-3">
                                    <i class="fas fa-eye fa-2x text-info mb-2"></i>
                                    <h6>View Attendance</h6>
                                    <p class="text-muted small">Check attendance records for specific dates</p>
                                </div>
                            </div>
                            <div class="col-md-3">
                                <div class="mb-3">
                                    <i class="fas fa-chart-line fa-2x text-warning mb-2"></i>
                                    <h6>Attendance Reports</h6>
                                    <p class="text-muted small">Generate detailed attendance reports and analytics</p>
                                </div>
                            </div>
                            <div class="col-md-3">
                                <div class="mb-3">
                                    <i class="fas fa-user-check fa-2x text-primary mb-2"></i>
                                    <h6>Student Reports</h6>
                                    <p class="text-muted small">View individual student attendance history</p>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    }

    <!-- Instructions for New Teachers -->
    @if (!Model.Batches.Any())
    {
        <div class="row">
            <div class="col-12">
                <div class="card border-warning">
                    <div class="card-header bg-warning text-dark">
                        <h5 class="mb-0"><i class="fas fa-exclamation-triangle"></i> Getting Started</h5>
                    </div>
                    <div class="card-body">
                        <h6>To start taking attendance, you need:</h6>
                        <ul class="mb-0">
                            <li>One or more batches assigned to you by the administrator</li>
                            <li>Active batches with enrolled students</li>
                            <li>Proper timing and room assignments for your batches</li>
                        </ul>
                        <div class="mt-3">
                            <p class="text-muted small">
                                <i class="fas fa-info-circle"></i>
                                Contact your system administrator to get batch assignments and start managing attendance.
                            </p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    }
</div>

@section Scripts {
    <script>
        $(document).ready(function() {
            // Add hover effects to batch cards
            $('.card.border-left-primary').hover(
                function() {
                    $(this).addClass('shadow-sm');
                },
                function() {
                    $(this).removeClass('shadow-sm');
                }
            );
        });
    </script>
}

@section Styles {
    <style>
        .border-left-primary {
            border-left: 4px solid #007bff !important;
        }
        
        .card:hover {
            transition: all 0.2s ease-in-out;
        }
        
        .btn-group-vertical .btn {
            white-space: nowrap;
        }
    </style>
}