@model StudentManagementSystem.ViewModels.TeacherViewModel

@{
    ViewData["Title"] = "Delete Teacher";
}

<div class="row">
    <div class="col-12">
        <div class="d-flex justify-content-between align-items-center mb-4">
            <h1><i class="fas fa-trash text-danger"></i> Delete Teacher</h1>
            <a asp-action="Index" class="btn btn-outline-secondary">
                <i class="fas fa-arrow-left"></i> Back to List
            </a>
        </div>
    </div>
</div>

<div class="row">
    <div class="col-12">
        <div class="alert alert-danger" role="alert">
            <h4 class="alert-heading"><i class="fas fa-exclamation-triangle"></i> Warning!</h4>
            <p>Are you sure you want to delete this teacher? This action cannot be undone.</p>
            <hr>
            <p class="mb-0">The teacher's account will be deactivated and they will lose access to the system.</p>
        </div>
    </div>
</div>

<div class="row">
    <div class="col-md-8">
        <div class="card">
            <div class="card-header bg-light">
                <h5><i class="fas fa-user"></i> Teacher Information</h5>
            </div>
            <div class="card-body">
                <div class="row">
                    <div class="col-md-6">
                        <div class="mb-3">
                            <label class="form-label fw-bold">Teacher Code:</label>
                            <p class="form-control-plaintext">@Model.TeacherCode</p>
                        </div>
                    </div>
                    <div class="col-md-6">
                        <div class="mb-3">
                            <label class="form-label fw-bold">Username:</label>
                            <p class="form-control-plaintext">
                                <span class="badge bg-light text-dark">@Model.Username</span>
                            </p>
                        </div>
                    </div>
                </div>
                <div class="row">
                    <div class="col-md-12">
                        <div class="mb-3">
                            <label class="form-label fw-bold">Full Name:</label>
                            <p class="form-control-plaintext">@Model.FullName</p>
                        </div>
                    </div>
                </div>
                <div class="row">
                    <div class="col-md-6">
                        <div class="mb-3">
                            <label class="form-label fw-bold">Status:</label>
                            <p class="form-control-plaintext">
                                @if (Model.Status == "Active")
                                {
                                    <span class="badge bg-success">Active</span>
                                }
                                else if (Model.Status == "Inactive")
                                {
                                    <span class="badge bg-warning">Inactive</span>
                                }
                                else
                                {
                                    <span class="badge bg-danger">Terminated</span>
                                }
                            </p>
                        </div>
                    </div>
                    <div class="col-md-6">
                        <div class="mb-3">
                            <label class="form-label fw-bold">Total Batches:</label>
                            <p class="form-control-plaintext">
                                <span class="badge bg-primary">@Model.PrimaryBatchCount Primary</span>
                                <span class="badge bg-secondary">@Model.SecondaryBatchCount Secondary</span>
                            </p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <div class="col-md-4">
        <div class="card">
            <div class="card-header bg-warning text-dark">
                <h5><i class="fas fa-exclamation-circle"></i> Important Notice</h5>
            </div>
            <div class="card-body">
                @if (Model.PrimaryBatchCount > 0 || Model.SecondaryBatchCount > 0)
                {
                    <div class="alert alert-warning" role="alert">
                        <h6>⚠️ Batch Assignments</h6>
                        <p>This teacher is currently assigned to:</p>
                        <ul class="mb-0">
                            @if (Model.PrimaryBatchCount > 0)
                            {
                                <li>@Model.PrimaryBatchCount Primary batch(es)</li>
                            }
                            @if (Model.SecondaryBatchCount > 0)
                            {
                                <li>@Model.SecondaryBatchCount Secondary batch(es)</li>
                            }
                        </ul>
                        <hr class="my-2">
                        <small class="text-muted">
                            Batch assignments will remain, but the teacher will lose access to them.
                        </small>
                    </div>
                }
                else
                {
                    <div class="alert alert-success" role="alert">
                        <h6>✅ No Active Assignments</h6>
                        <p class="mb-0">This teacher has no active batch assignments. Safe to delete.</p>
                    </div>
                }
                
                <div class="mt-3">
                    <h6>What will happen:</h6>
                    <ul class="list-unstyled">
                        <li><i class="fas fa-check text-success"></i> Teacher record will be marked as deleted</li>
                        <li><i class="fas fa-check text-success"></i> Login account will be deactivated</li>
                        <li><i class="fas fa-check text-success"></i> Data will be preserved for audit</li>
                        <li><i class="fas fa-times text-danger"></i> Teacher cannot access the system</li>
                    </ul>
                </div>
            </div>
        </div>
    </div>
</div>

<div class="row mt-4">
    <div class="col-12">
        <div class="card">
            <div class="card-body">
                <form asp-action="Delete" method="post">
                    <input type="hidden" asp-for="Id" />
                    <div class="d-flex justify-content-end">
                        <a asp-action="Details" asp-route-id="@Model.Id" class="btn btn-info me-2">
                            <i class="fas fa-eye"></i> View Details
                        </a>
                        <a asp-action="Edit" asp-route-id="@Model.Id" class="btn btn-primary me-2">
                            <i class="fas fa-edit"></i> Edit Instead
                        </a>
                        <a asp-action="Index" class="btn btn-secondary me-2">
                            <i class="fas fa-times"></i> Cancel
                        </a>
                        <button type="submit" class="btn btn-danger" onclick="return confirm('Are you absolutely sure you want to delete this teacher? This action cannot be undone!')">
                            <i class="fas fa-trash"></i> Yes, Delete Teacher
                        </button>
                    </div>
                </form>
            </div>
        </div>
    </div>
</div>

@section Scripts {
    <script>
        // Additional confirmation for delete action
        document.querySelector('form').addEventListener('submit', function(e) {
            if (!confirm('⚠️ FINAL WARNING: This will permanently delete the teacher account and deactivate their system access. Are you absolutely certain?')) {
                e.preventDefault();
            }
        });
    </script>
}